import csv, time, datetime, ast, json
from graphqlclient import GraphQLClient

graphqlUrl = 'https://PALACIO.api.fluentretail.com/graphql'
client = GraphQLClient(graphqlUrl)
client.inject_token("Bearer e5b7e8a1-30bd-421d-bc11-d9bcebd10f4f")

def process(ffList):
    ffListUnique = list(set(ffList))
    print(len(ffListUnique))
    multiSku = []
    singleSku = []
    for ffId in ffListUnique:
        query = "query{"
        query += "fulfilmentById(id:\"" +str(ffId)+ "\"){id status items{edges{node{ref}}}}"
        query += "}"
        response = client.execute(query)
        response = json.loads(response)
        if len(response['data']['fulfilmentById']['items']['edges']) == 1:
            singleSku.append(ffId)
        else:
            multiSku.append(ffId)

    with open('singleSku.txt','w') as f:
        f.write(str(singleSku))
        print(len(singleSku))
    with open('multiSku','w') as f:
        f.write(str(multiSku))
        print(len(multiSku))

ffList=[885329,885455,885675,887743,889063,889062,889084,889084,889277,889479,889649,889793,889824,889824,889824,889824,889824,889824,889824,889879,890149,890870,891713,891905,892027,893025,893461,894154,894175,894481,895220,895562,895901,896273,896273,896612,896828,923454,896928,897157,897430,897354,899042,899271,899593,899941,900007,903401,905272,905994,876777,862416,862543,862695,862749,862749,862811,862976,862923,862981,863163,863366,863236,863379,863408,863410,863582,863662,863662,863607,863754,864034,864388,864448,864537,864719,865195,865728,866006,866232,902529,866312,866607,866705,867318,867326,867409,867741,867749,867779,867807,867905,867982,868365,868376,868717,868816,868944,869404,869428,869476,869659,869748,870011,870234,870379,870411,870592,870948,870748,870797,870802,870808,870986,871455,871803,872286,872441,872867,872898,873072,873288,873424,873456,873652,874000,874626,874627,874627,874627,874627,874650,874651,874675,875041,875529,875578,875607,876527,876930,877578,877604,878382,878487,879050,879062,879115,879277,879631,880093,880944,880909,880933,880987,880938,881023,881057,881168,881288,881433,881765,881831,882086,882295,882203,882203,882523,883061,883213,883271,883442,884211,884214,884214,884214,884214,884304,884374,885018,885018,885018,885220,885712,885799,885946,886604,886481,886945,886944,887315,887198,887198,887198,887561,887614,887614,887974,888399,888474,889045,889122,889759,889759,889759,889759,889792,889819,890023,890034,890351,890768,891024,891151,891768,891782,891712,892579,892689,892786,893231,893253,893361,917184,893335,894949,895432,896083,896602,896939,897356,897395,898443,898527,929717,899728,899800,900658,901432,902317,902361,902563,902763,903625,904532,904815]
start = time.time()

process(ffList)

print("Time taken: " + str((time.time()-start)/60) + " minutes")
