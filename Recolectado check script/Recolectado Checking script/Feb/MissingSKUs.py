import json, csv, requests, time
from graphqlclient import GraphQLClient
from http.client import IncompleteRead
from datetime import datetime, timedelta


accountId = 'PALACIO'
oauth_url = 'https://palacio.api.fluentretail.com:443/oauth/token?username=elpalaciodehierro_admin&password=GT8Y4Q&client_id=PALACIO&client_secret=44f824ad-eb5d-4936-af10-86ebbcf5be61&grant_type=password&scope=api'

graphql_url = 'https://PALACIO.api.fluentretail.com/graphql'


def get_token():
    auth_token_response = requests.post(oauth_url)
    if auth_token_response.status_code != 200:
        print("Couldn't get auth token {}".format(auth_token_response.status_code))
    access_token = 'bearer ' + auth_token_response.json()['access_token']
    #print("Access token: {}".format(access_token))
    return access_token



with open('testing.csv','a') as f, open('output.csv','a') as output:

    f.write('S.No, Order Id, SKU Refs, Fulfilment ID, ff Status, SKU REFS, Result\n')
    output.write('Order Id, Status, CreatedOn, SKU Refs, Required Quantity, Price\n')

    def get_all_data():

        inputIdList = [1213255,1213252,1213211,1213191,1213167,1213163,1213105,1213105,1213064,1212987,1212986,1212961,1212940,1212927,1212905,1212864,1212793,1212783,1212778,1212761,1212755,1212718,1212699,1212691,1206630,1212678,1212664,1212626,1212568,1212545,1212528,1212509,1212499,1212498,1212467,1212467,1212467,1212440,1212440,1212444,1212421,1212379,1212340,1212248,1212220,1212114,1212085,1212081,1212064,1212040,1212019,1212011,1211989,1211989,1211989,1211978,1211973,1211960,1211960,1211959,1211923,1211920,1211902,1211902,1211902,1211865,1211845,1211831,1211823,1211808,1211764,1211764,1211764,1211764,1211728,1211663,1211648,1211629,1211601,1211575,1211525,1211525,1211473,1211465,1211440,1211427,1211384,1211378,1211370,1211310,1211249,1211239,1211203,1211203,1211197,1211164,1211136,1211128,1211097,1211093,1211091,1211025,1211022,1211022,1211022,1211022,1211022,1210965,1210961,1210956,1210855,1210846,1210840,1210831,1210819,1210812,1210791,1210773,1210743,1210736,1205407,1210723,1210703,1210687,1210663,1210621,1210618,1210609,1210588,1210558,1210539,1210539,1210476,1210465,1210460,1210445,1210418,1210416,1210406,1210252,1210241,1210233,1210217,1210216,1210123,1210119,1210115,1210098,1210072,1210072,1210072,1210068,1210068,1210068,1210068,1210005,1210003,1210003,1210003,1209997,1209996,1209990,1209990,1209990,1209990,1209993,1209946,1209946,1209946,1209946,1209822,1209781,1209777,1209726,1209725,1209700,1209645,1209588,1209566,1209565,1209477,1209460,1209447,1209411,1209386,1209375,1209355,1209297,1209235,1209228,1209212,1209210,1209208,1209208,1209179,1209179,1209161,1209156,1209111,1209076,1209036,1209025,1208978,1208860,1208805,1208796,1208699,1208636,1208630,1208552,1208451,1208451,1208372,1208278,1208278,1208259,1208238,1208204,1208192,1208182,1208180,1208166,1208126,1208113,1208105,1208105,1208077,1208053,1208020,1174766,1207942,1200107,1207931,1207922,1207919,1207912,1207888,1207888,1207851,1207827,1207827,1207818,1207812,1207795,1207782,1207742,1207676,1207672,1207608,1207594,1207556,1207532,1207525,1207499,1207457,1207448,1207446,1207432,1207432,1207432,1207429,1207429,1207429,1207411,1207355,1207355,1207355,1207355,1207284,1207277,1207267,1207246,1207242,1207240,1207202,1207156,1207155,1207112,1207099,1207078,1207070,1207006,1206989,1206989,1206989,1206989,1206990,1206986,1206956,1206888,1206888,1206886,1206879,1206867,1206865,1206857,1206856,1206850,1206826,1206653,1206652,1206525,1206525,1206525,1206511,1206511,1206500,1206500,1206500,1206480,1206456,1206422,1206393,1206369,1206367,1206327,1206324,1206250,1206250,1206224,1206219,1206190,1206171,1206167,1206128,1206092,1206063,1206047,1206048,1206046,1206012,1206012,1206012,1206005,1205970,1205910,1205876,1205860,1205830,1205828,1205797,1205795,1205773,1205734,1205725,1205694,1205694,1205694,1205694,1205653,1205627,1205615,1205605,1205605,1205586,1205552,1205483,1205477,1205407,1205387,1205344,1205334,1205334,1205282,1205278,1205251,1205243,1205215,1205215,1205204,1188759,1205181,1205167,1205166,1205134,1205129,1205119,1205113,1205108,1205100,1205051,1205039,1205031,1205031,1205009,1205004,1205004,1205004,1205003,1204977,1204969,1204960,1204959,1204921,1204899,1204899,1204826,1204747,1204747,1204741,1204709,1204699,1204693,1204663,1204626,1204598,1204597,1204587,1204584,1204491,1204491,1204488,1204416,1204410,1204352,1204197,1204177,1204130,1204130,1204118,1204093,1204093,1204087,1204085,1204047,1204047,1204040,1204037,1204037,1204037,1204007,1204004,1203973,1203972,1203921,1203914,1203880,1203804,1203804,1203799,1203764,1203751,1203739,1203728,1203706,1203703,1203648,1203629,1203620,1203591,1203573,1203538,1203524,1203507,1203494,1203490,1203445,1203416,1203410,1203388,1203374,1203355,1196460,1203314,1203314,1203309,1203267,1201521,1203209,1203209,1203126,1203120,1203115,1203107,1203107,1203106,1203100,1203094,1203091,1203089,1203028,1202988,1202988,1202988,1202979,1202967,1202927,1202918,1202910,1202907,1202873,1202871,1202855,1202742,1202721,1202721,1202721,1202720,1202703,1202688,1202684,1202684,1202671,1202655,1202640,1202579,1202491,1202485,1202467,1202452,1202440,1202440,1202436,1202397,1202362,1202348,1202291,1066243,1202246,1202216,1202215,1202214,1202212,1202200,1202185,1202061,1202061,1202030,1202029,1202013,1201974,1201939,1201866,1201827,1201825,1201743,1201719,1201704,1201622,1201619,1201611,1201600,1201600,1201586,1201575,1201558,1201556,1201555,1201539,1201521,1201488,1201364,1201365,1201363,1201363,1201363,1201358,1201340,1201336,1201312,1201314,1201281,1201281,1201281,1201281,1201238,1201183,1201183,1201180,1201180,1201178,1201178,1201177,1201145,1201145,1201133,1201124,1201101,1201095,1201062,1201069,1201045,1201035,1201035,1201030,1201003,1200982,1200979,1200959,1200949,1200917,1200905,1200859,1200819,1200808,1200803,1200801,1200781,1200773,1200752,1200740,1200735,1200721,1200720,1200704,1200704,1200675,1200674,1200665,1200665,1200665,1200624,1200602,1200593,1200514,1200509,1200488,1200485,1200477,1200423,1200409,1200354,1200350,1200348,1200342,1200341,1200337,1200321,1200317,1200272,1200242,1200209,1200199,1200196,1200190,1200169,1200147,1200136,1200126,1200122,1200096,1200093,1200042,1200010,1200004,1199994,1199994,1199994,1199976,1199970,1199962,1199962,1199962,1199947,1199947,1199947,1199947,1199915,1199905,1199831,1199829,1199829,1199815,1199779,1199746,1199700,1199668,1199662,1199546,1199545,1199497,1199460,1199458,1199451,1199451,1199420,1199403,1199369,1199367,1199350,1199257,1199237,1199228,1199224,1199216,1199166,1199152,1199146,1199104,1199104,1199104,1199084,1199045,1199043,1199025,1199004,1198991,1198984,1198972,1198917,1198916,1198916,1198883,1198877,1198868,1198864,1198835,1198835,1198827,1198784,1198781,1198729,1198644,1198624,1198616,1198606,1198583,1198567,1198546,1198530,1198530,1198530,1198520,1198508,1198468,1198424,1198420,1198420,1198403,1198389,1198378,1198345,1198339,1198334,1198322,1198296,1198242,1198218,1198203,1198194,1198194,1198195,1198166,1198165,1198162,1198136,1198114,1198107,1198077,1198074,1198036,1198030,1197990,1197970,1197964,1197948,1197942,1197869,1197862,1197844,1197840,1196314,1197799,1197727,1197720,1197710,1197697,1197673,1197641,1197622,1197603,1197163,1197569,1197567,1197557,1197500,1197500,1197500,1197482,1197473,1197473,1197473,1197471,1197437,1197423,1197415,1197338,1197253,1197240,1197210,1197210,1197135,1197104,1197087,1197066,1197059,1197056,1197056,1197058,1197049,1197047,1196997,1196994,1196968,1196960,1196920,1196853,1196834,1196828,1196806,1196797,1196789,1196789,1196786,1196781,1196775,1196752,1196656,1196647,1196645,1196627,1196621,1196619,1196603,1196601,1196599,1196596,1196567,1196565,1196541,1196528,1196475,1196460,1196460,1196460,1196460,1196458,1196404,1196380,1196378,1196376,1196340,1196340,1196340,1196340,1196343,1196308,1196300,1196244,1196238,1196152,1196088,1196085,1196050,1196033,1195993,1195974,1195970,1195960,1195959,1195957,1195952,1195948,1195948,1195948,1195946,1195943,1195916,1195852,1195845,1195833,1195831,1195809,1195809,1195809,1195794,1195786,1195723,1195704,1195695,1195695,1195679,1195658,1195640,1195576,1195530,1195527,1193875,1195497,1195475,1194511,1195431,1195399,1195393,1195370,1195370,1195365,1195344,1195337,1195337,1195286,1195247,1195198,1195184,1195179,1195126,1195119,1195031,1195015,1194923,1194898,1194839,1194809,1194809,1194808,1194809,1194808,1194810,1194800,1194800,1194793,1194793,1194793,1194788,1194745,1194738,1194721,1194708,1194693,1194683,1194670,1194643,1194621,1194614,1194613,1194590,1194553,1194511,1194473,1194398,1194386,1194341,1194333,1194329,1194281,1194235,1194224,1194198,1194198,1194198,1194183,1194183,1194150,1194150,1194150,1194130,1194079,1194068,1194036,1194017,1194000,1193970,1193956,1193952,1193927,1193927,1193897,1193890,1193875,1193874,1193855,1193855,1193855,1193831,1193787,1193778,1193751,1193702,1193646,1193636,1193618,1193602,1193565,1193555,1193489,1193440,1193434,1193399,1193380,1193372,1193330,1193319,1193292,1193275,1193272,1193271,1193265,1193215,1193193,1193149,1193134,1193133,1193123,1193105,1193080,1193063,1193063,1193013,1190447,1192951,1192935,1192917,1192910,1192906,1192862,1192859,1192823,1192800,1192763,1192757,1192720,1192627,1192627,1192627,1192603,1192583,1192534,1192529,1192462,1192435,1192427,1192377,1192371,1192321,1192289,1192266,1192261,1192254,1192243,1192203,1192197,1192130,1192127,1192109,1192109,1192108,1192101,1192101,1192101,1192056,1192054,1191967,1191959,1191937,1191894,1191894,1191861,1191849,1191771,1191769,1191768,1191678,1191678,1191680,1191671,1191671,1191656,1191635,1191601,1191563,1191547,1191545,1191503,1191479,1191477,1191408,1191403,1191381,1191365,1191349,1191326,1191323,1191323,1191323,1191269,1191269,1191269,1191205,1191177,1191160,1191151,1191112,1191110,1191108,1191108,1191108,1191108,1191065,1191014,1190973,1190964,1190944,1190925,1190922,1190878,1190868,1190624,1190839,1190831,1190767,1190731,1190577,1190559,1190558,1190556,1190447,1190446,1190446,1190380,1190348,1190328,1190310,1190299,1190295,1190268,1190236,1190227,1190171,1190086,1190086,1190086,1190050,1190043,1190000,1189996,1189995,1189906,1189899,1189886,1189860,1189854,1189823,1189756,1189748,1189748,1189744,1189744,1189730,1189715,1189708,1189690,1189682,1189677,1189654,1189610,1189609,1189604,1189603,1189592,1189586,1189572,1189517,1189504,1189495,1189484,1189465,1189422,1189393,1189375,1189353,1189325,1189312,1189305,1189283,1189271,1189264,1189245,1189240,1189161,1189081,1189040,1188932,1188925,1188898,1188799,1188783,1188779,1188765,1188735,1188723,1188687,1188670,1188670,1188637,1188552,1188531,1188519,1188500,1188459,1188449,1188441,1188415,1188413,1188343,1188288,1188288,1188264,1188252,1188226,1180305,1188170,1188167,1188150,1188154,1188105,1188071,1188051,1182198,1188001,1188000,1187988,1187967,1187950,1187915,1187907,1187903,1187889,1187851,1187783,1187743,1187723,1187708,1187682,1187676,1187670,1187640,1187594,1187591,1187587,1187575,1187574,1187542,1187542,1187528,1187483,1187470,1187470,1187437,1187415,1187413,1187408,1187351,1187327,1187307,1187292,1187287,1187254,1187254,1187212,1187193,1187178,1187084,1187084,1187083,1187055,1187050,1187044,1187009,1186990,1186890,1186888,1186864,1186861,1186861,1186841,1186841,1186781,1186752,1186752,1186742,1186682,1186640,1186599,1186529,1186523,1186434,1186434,1186430,1186426,1186424,1186402,1186345,1186315,1186284,1186271,1186185,1186179,1186164,1186152,1186121,1186103,1186093,1186059,1186040,1186036,1186017,1185997,1185997,1185997,1185997,1185997,1186003,1185959,1185954,1185946,1185890,1185859,1185859,1185859,1185854,1185809,1185809,1185783,1185774,1185742,1185742,1185742,1185742,1185736,1185729,1185726,1185709,1185708,1185708,1185696,1185663,1185638,1185635,1185631,1185612,1185602,1185602,1185597,1185586,1185561,1185552,1185544,1185525,1185520,1185518,1185516,1185510,1185505,1185494,1185494,1185487,1185483,1185429,1185429,1185436,1185437,1185418,1185416,1185399,1185392,1185392,1185381,1185284,1185267,1185253,1185246,1185238,1185236,1185183,1185137,1185137,1185137,1185132,1185127,1185123,1185082,1185035,1185035,1184978,1184964,1184958,1184877,1184853,1184437,1184837,1184833,1184831,1184822,1184761,1184760,1184718,1184648,1184633,1184622,1184579,1184575,1184572,1184547,1184532,1184505,1184464,1184448,1184430,1184416,1184402,1184395,1184389,1184364,1184340,1184335,1184335,1184330,1184286,1184256,1184239,1184232,1184203,1184194,1184167,1184143,1184138,1184134,1184122,1184117,1184114,1184100,1184083,1184059,1184027,1184000,1183962,1183930,1183875,1183818,1183803,1183801,1183792,1183775,1183767,1183767,1183738,1183737,1183719,1183681,1183672,1183621,1183621,1183619,1183536,1183526,1183522,1183518,1183408,1183381,1183365,1183365,1183329,1183329,1183329,1183290,1183289,1183281,1183281,1183281,1183246,1183232,1183230,1183220,1183215,1183193,1183173,1183173,1183161,1183118,1183052,1183044,1183029,1183005,1182985,1182980,1182968,1182915,1182911,1182898,1182885,1182868,1182796,1182791,1182735,1182729,1182729,1182729,1182729,1182729,1182727,1182727,1182727,1182725,1182725,1182710,1182698,1182698,1182666,1182655,1182637,1182611,1182604,1182581,1182546,1182546,1182519,1182503,1182470,1182464,1182461,1182451,1182416,1182410,1182393,1182382,1182376,1182345,1182294,1182287,1182279,1182236,1182233,1182204,1182198,1182183,1182131,1182109,1182090,1182074,1181962,1181948,1181945,1181945,1181943,1181934,1181927,1181907,1174906,1181876,1181875,1181874,1181853,1181864,1181864,1181806,1181762,1181754,1181726,1181726,1181726,1181725,1181696,1181657,1181652,1181616,1181599,1181583,1181573,1181554,1181536,1053877,1181467,1181370,1181364,1181358,1181354,1181337,1181324,1181305,1181284,1181268,1181218,1181211,1181145,1181145,1181145,1181145,1181078,1181007,1180990,1179525,1180953,1180838,1180814,1180716,1180696,1180652,1180612,1180588,1180588,1180588,1180588,1180573,1180543,1180509,1180467,1180458,1180447,1180447,1180449,1180430,1180404,1180404,1180394,1180380,1180305,1180270,1180268,1180240,1180229,1180204,1180194,1180184,1180168,1180167,1180164,1180158,1180107,1180105,1180071,1180052,1180043,1179977,1179950,1179912,1179911,1179882,1179871,1179831,1179744,1179744,1179735,1179728,1179728,1179720,1179711,1179702,1179601,1179528,1179525,1179525,1179525,1179525,1179525,1179485,1179475,1179475,1179464,1179386,1179300,1179282,1179282,1179282,1179282,1179282,1179282,1179259,1179227,1179226,1179222,1179216,1179185,1179171,1179142,1179136,1179131,1179124,1179117,1179105,1179105,1179105,1179099,1179077,1179058,1179055,1179055,1179055,1179025,1179024,1179020,1178961,1178961,1178961,1178908,1178908,1178913,1178895,1178895,1178895,1178865,1178864,1178850,1178836,1178831,1178820,1178806,1178799,1178746,1178731,1178721,1178720,1178699,1178680,1178624,1178624,1178624,1178600,1178592,1178592,1178575,1178554,1178547,1178517,1178517,1178495,1178474,1178460,1178451,1178432,1178432,1178432,1178434,1178381,1178367,1178348,1178308,1178287,1178287,1178287,1178284,1178283,1178282,1178282,1178282,1178282,1178282,1178236,1178192,1178162,1178158,1178136,1178105,1178105,1178090,1178087,1178084,1178066,1178065,1177960,1177961,1177956,1177940,1177935,1177913,1177904,1177885,1177841,1177814,1177814,1177781,1177771,1177770,1177730,1177681,1177619,1177614,1177598,1177598,1177598,1177493,1177453,1177423,1177378,1177353,1177283,1177283,1177283,1177283,1177276,1177246,1177243,1177207,1177194,1177194,1177194,1177176,1177135,1177117,1177082,1177074,1176970,1176967,1176901,1176861,1176855,1176846,1176835,1176808,1176800,1176781,1176779,1176774,1176752,1176734,1176734,1176700,1176700,1176680,1176672,1176672,1176672,1176666,1176653,1176601,1176595,1176595,1176595,1176584,1176564,1176536,1176529,1176530,1176526,1176503,1176486,1176475,1176463,1176417,1176398,1176390,1176377,1176370,1176344,1176330,1176248,1176220,1176218,1176179,1176151,1176146,1176140,1176128,1176109,1176086,1176058,1175995,1175994,1175959,1175896,1175892,1175889,1175889,1175829,1175829,1175790,1175763,1175717,1175687,1175687,1175686,1175686,1175684,1175625,1175612,1175603,1175549,1175546,1175543,1175538,1175512,1175504,1175456,1175456,1175441,1175414,1175399,1175374,1175360,1175350,1175326,1175295,1175283,1175283,1175283,1175212,1175183,1175183,1175183,1175183,1175184,1175171,1175165,1175105,1175060,1175031,1175013,1174979,1128858,1174937,1174923,1174911,1174909,1174877,1174867,1153784,1174855,1174850,1174776,1174740,1174662,1174638,1174631,1174620,1174620,1174582,1174582,1174582,1174549,1174471,1174457,1174411,1174392,1174383,1174364,1174361,1174354,1174343,1174257,1174203,1174190,1174158,1174155,1174130,1174114,1174114,1174113,1174086,1174077,1174054,1174045,1174002,1174002,1174002,1173986,1173977,1173961,1173957,1173910,1173910,1173917,1173904,1173901,1173140,1173859,1173821,1173811,1173785,1173779,1173774,1173753,1173746,1173739,1173739,1173731,1173732,1173707,1173671,1173670,1173654,1173647,1173593,1173587,1173584,1173575,1173560,1173545,1173543,1173543,1173530,1173530,1173528,1173488,1173480,1173480,1173468,1173468,1173468,1173469,1173460,1173401,1173400,1173390,1173365,1173364,1173345,1173335,1173323,1173289,1173265,1173170,1173129,1173130,1173117,1173094,1173043,1173039,1165676,1172953,1172907,1172892,1172866,1172866,1172843,1172838,1172832,1172823,1172763,1172757,1172751,1172745,1169446,1172682,1172614,1172602,1172601,1172601,1172588,1172588,1172570,1172563,1172562,1172515,1172483,1172472,1172467,1172438,1172407,1172390,1172386,1172374,1172350,1172195,1172154,1172152,1172139,1172127,1172064,1172049,1172038,1172021,1171971,1171963,1171952,1171925,1171921,1171874,1171871,1171849,1171849,1171818,1171806,1170636,1171634,1171561,1171483,1171421,1171413,1171413,1171410,1171360,1171360,1171360,1171317,1171317,1171308,1171302,1171296,1171275,1171272,1171269,1171228,1171223,1171217,1171202,1171195,1171189,1171182,1171179,1171164,1171164,1171141,1171107,1171101,1171082,1171081,1171081,1171081,1171043,1171029,1171018,1170996,1170991,1170964,1170931,1170911,1170901,1170875,1170866,1170862,1170862,1170835,1170820,1170803,1170803,1170727,1170680,1170669,1170648,1170635,1170629,1170616,1170593,1170576,1170545,1170503,1170492,1170479,1170442,1170363,1170311,1170280,1170115,1170013,1169993,1169993,1169956,1169950,1169939,1169877,1169876,1169854,1169850,1169820,1169786,1169719,1169626,1169589,1169595,1169575,1169556,1169548,1169548,1169478,1169410,1169396,1169331,1169321,1169307,1169281,1169280,1169265,1169261,1169151,1169095,1169075,1169057,1169053,1169047,1169047,1169047,1169029,1169022,1169012,1169008,1168980,1168977,1168928,1168928,1168927,1168926,1168863,1168869,1168856,1168847,1168799,1168794,1168784,1168742,1168726,1168717,1168674,1168660,1168617,1168593,1168593,1168593,1168580,1168548,1168548,1168547,1168453,1168442,1168437,1168393,1168378,1168378,1168365,1168334,1168307,1168307,1168266,1168255,1168255,1168254,1168218,1168209,1168191,1168177,1168154,1168125,1168125,1168090,1168045,1168008,1168004,1168004,1167999,1167948,1167949,1167944,1167947,1157606,1167924,1167924,1167893,1167852,1167835,1167815,1167793,1167783,1167767,1167766,1167766,1167766,1167750,1167702,1167701,1167677,1167675,1167655,1167646,1167627,1167608,1167541,1167479,1167471,1167463,1167442,1167429,1167427,1167419,1167418,1167406,1167385,1167360,1167349,1167333,1167324,1167286,1167256,1167243,1167224,1167221,1167216,1167196,1167138,1167133,1167124,1164734,1167108,1167103,1167072,1167029,1166978,1166949,1166921,1166917,1166905,1166874,1166838,1166775,1166775,1166751,1166726,1166711,1166705,1166700,1166691,1166666,1166649,1166632,1166597,1166574,1166570,1166540,1166513,1166501,1166491,1166486,1166476,1166474,1166469,1166464,1166455,1166438,1030492,1159742,1166389,1164028,1166365,1166333,1166317,1166272,1166262,1166250,1166222,1166177,1166172,1166171,1166149,1166145,1166145,1166130,1166124,1166073,1166042,1166039,1166013,1166006,1165993,1165977,1165976,1165975,1162305,1165955,1165939,1165937,1165918,1165909,1165905,1165870,1165837,1165816,1165810,1165810,1165807,1165807,1165807,1165782,1165764,1165762,1165718,1165691,1165676,1165676,1165676,1165643,1165591,1165591,1165547,1165527,1165519,1165492,1165486,1165460,1165413,1165413,1165400,1165378,1165373,1165368,1165338,1165328,1165302,1165298,1165285,1165214,1165202,1165201,1165201,1165141,1165140,1165134,1165134,1165107,1165088,1165088,1165088,1165052,1165044,1165012,1164985,1164985,1164914,1164914,1164912,1164878,1164867,1164847,1164831,1164784,1164759,1164734,1163739,1164708,1164690,1164689,1164630,1164610,1164591,1151606,1164544,1155406,1164530,1164502,1164472,1164445,1164445,1164445,1164444,1164404,1164359,1164359,1164359,1164316,1164293,1164281,1164270,1164227,1164225,1164224,1164219,1164215,1164202,1164188,1164188,1164188,1164183,1164182,1164168,1164165,1164085,1164074,1164032,1164028,1164024,1164018,1163938,1163919,1163899,1163891,1163853,1163827,1163815,1163814,1163792,1163791,1163742,1163741,1163739,1163739,1163713,1163696,1163689,1163663,1163665,1163648,1163603,1163585,1163565,1163543,1163524,1163519,1163507,1163498,1163481,1163481,1163481,1163474,1163446,1163428,1163409,1163361,1163329,1163322,1163317,1163300,1163298,1163297,1163239,1163234,1163234,1163234,1163221,1163201,1163200,1163165,1163164,1163163,1163142,1163121,1163121,1163011,1163006,1162893,1162893,1162817,1162790,1162788,1162781,1162750,1162736,1162704,1162693,1162689,1162675,1162674,1162669,1162621,1162596,1162581,1162581,1162581,1162581,1162574,1162571,1162558,1162528,1162484,1162484,1162472,1162466,1162466,1162412,1162403,1162403,1162403,1162400,1162391,1162391,1162391,1162391,1162371,1162371,1162312,1162305,1162305,1162305,1162305,1162296,1162284,1162271,1162235,1162214,1162165,1162162,1162160,1162157,1162154,1162136,1162134,1162091,1162080,1162056,1162055,1161999,1161994,1161977,1161945,1161893,1133882,1161865,1161830,1161830,1161812,1161798,1161798,1161753,1161742,1161734,1161734,1161734,1161719,1161719,1161711,1161689,1161647,1161632,1161600,1161569,1161533,1161527,1161473,1161454,1161420,1161418,1161418,1161369,1161367,1161356,1161341,1161325,1133829,1161256,1161252,1161216,1161213,1161213,1161169,1161139,1161108,1161104,1161104,1161072,1161047,1161027,1161022,1161018,1161007,1161001,1160981,1160974,1160965,1160959,1160939,1160937,1160918,1157947,1160895,1160895,1160799,1160785,1160781,1160781,1160774,1160760,1160741,1160741,1160741,1160741,1160737,1160698,1160698,1160649,1160630,1160622,1160608,1160608,1160602,1160584,1160569,1160569,1160517,1160486,1160422,1160410,1160372,1160331,1160331,1160320,1160319,1160306,1160287,1160279,1160270,1160272,1160270,1160266,1160219,1160204,1160201,1160189,1160173,1160163,1160135,1160120,1160119,1160107,1160106,1160073,1160073,1160070,1160052,1160050,1160022,1160007,1159986,1159974,1159967,1159941,1159933,1159905,1159877,1159862,1159838,1159814,1159797,1159734,1159712,1159690,1159661,1159642,1159640,1159626,1159618,1159608,1159510,1159510,1159499,1159499,1159478,1159464,1159464,1159462,1159449,1159405,1159398,1159368,1159332,1159296,1159291,1159274,1159267,1159261,1159221,1159186,1159141,1159105,1159102,1159100,1159097,1159080,1159049,1159043,1158979,1158939,1125652,1158887,1158880,1148262,1158837,1158802,1148730,1158749,1158749,1158750,1158741,1158737,1158715,1158684,1158684,1158655,1158650,1158632,1158581,1158578,1158575,1158554,1158542,1158539,1158529,1158509,1158487,1158487,1158487,1158487,1158483,1158449,1158441,1158427,1158419,1158419,1158400,1133800,1158362,1158347,1158329,1158318,1158299,1158280,1158270,1158225,1158225,1158224,1158188,1158158,1158165,1158131,1158130,1158130,1158130,1158065,1158009,1157995,1157995,1157995,1157995,1157978,1157977,1157947,1157947,1157947,1157922,1157835,1157820,1157797,1157776,1157765,1157731,1157731,1157677,1157670,1157643,1157597,1157591,1157583,1157583,1157583,1157569,1157554,1157515,1157498,1157476,1157471,1157439,1157424,1157424,1157416,1157405,1016427,1157360,1157336,1157326,1157301,1157276,1157076,1157071,1157071,1157065,1157045,1157027,1156975,1156963,1156956,1156939,1156900,1156872,1156779,1156764,1156754,1156754,1156730,1156702,1156699,1156679,1156679,1156679,1156666,1156662,1156615,1156615,1156615,1156610,1156590,1156583,1156573,1156566,1156566,1156563,1156502,1156459,1156455,1156455,1156455,1156440,1156416,1156383,1156360,1156354,1156303,1156293,1156292,1156288,1156285,1156252,1156239,1156220,1156219,1156142,1156142,1156142,1156125,1156120,1156113,1156048,1156043,1156043,1156043,1156043,1156043,1156016,1156011,1155903,1155903,1155886,1155879,1155872,1155872,1155857,1155848,1155844,1155833,1155824,1155824,1155819,1155790,1155772,1155769,1155664,1155653,1155603,1155603,1155586,1155542,1155460,1155458,1155456,1155428,1155404,1155324,1155319,1155304,1155276,1155276,1155277,1155274,1155238,1155150,1155106,1155104,1155101,1154989,1152321,1152321,1154937,1154926,1154912,1154890,1154839,1154833,1154833,1154720,1154702,1154701,1154670,1154636,1154636,1154637,1154585,1154585,1154585,1154553,1154533,1154514,1154468,1154468,1154447,1154443,1154443,1154432,1138563,1154399,1154338,1154338,1154338,1154338,1154337,1136094,1154274,1154219,1154208,1154193,1154193,1154194,1154171,1154166,1154154,1154073,1154069,1154052,1154052,1153937,1153937,1153886,1153839,1153838,1153833,1153786,1153777,1153752,1153726,1153699,1153698,1143407,1153632,1153610,1153610,1153591,1153562,1153437,1153407,1153403,1153361,1153354,1153313,1153296,1153283,1153237,1153220,1153152,1153139,1153139,1153120,1153112,1153101,1153085,1153049,1153006,1009074,1152972,1152945,1152945,1152891,1152891,1152891,1152862,1152836,1152836,1152780,1152729,1152721,1152668,1152542,1152489,1152489,1152488,1152488,1152473,1152470,1152432,1152432,1152404,1152402,1152376,1152376,1152368,1152368,1152341,1152318,1152310,1152247,1152239,1152181,1152158,1152092,1151859,1151855,1151850,1151830,1136024,1151700,1151690,1151690,1151676,1151676,1151667,1151624,1151615,1151607,1129252,1151545,1151545,1151545,1151545,1151483,1151415,1151414,1151404,1151399,1151388,1151377,1151366,1151361,1151300,1151296,1151279,1151258,1151149,1139955,1151093,1151079,1151072,1151049,1151025,1151023,1151023,1151005,1150980,1150948,1150945,1150945,1150905,1150892,1150855,1150855,1150836,1150823,1150793,1150759,1150661,1150615,1150609,1150590,1150580,1150558,1150558,1150489,1150474,1150462,1150434,1150412,1150394,1150363,1150372,1135291,1150280,1150249,1150243,1150243,1150243,1150240,1150240,1150240,1150238,1150166,1150166,1150166,1150145,1150143,1150134,1150126,1150119,1150107,1150080,1150063,1150015,1149945,1149945,1149929,1149928,1149928,1149896,1149870,1149870,1149870,1149838,1149778,1149753,1149735,1149735,1149686,1149657,1149632,1149631,1149624,1149551,1149505,1149505,1149493,1149493,1149377,1149321,1149283,1149284,1149233,1149233,1149233,1149214,1149169,1149169,1149169,1149169,1149153,1149107,1149107,1149075,1149058,1149058,1149046,1149032,1149032,1149032,1148951,1148942,1148892,1148892,1148896,1148892,1148834,1148831,1148803,1148799,1148788,1148782,1148773,1148669,1148573,1148549,1148549,1148532,1148517,1148517,1148517,1148454,1148428,1148406,1148406,1148406,1148397,1148336,1148335,1148281,1148262,1148262,1148262,1148262,1148250,1148238,1148235,1148206,1148148,1148129,1148129,1148129,1148079,1148058,1148041,1148025,1148001,1147989,1147962,1147950,1147950,1147911,1147876,1147846,1147816,1147802,1147790,1147790,1147790,1147769,1130719,1147648,1147647,1147623,1147623,1147555,1147555,1147524,1147477,1147428,1147414,1147399,1138000,1147344,1129812,1147246,1147246,1147234,1147215,1147215,1147215,1147153,1147153,1147153,1147150,1147140,1147140,1127604,1147062,1147011,1146947,1146947,1146947,1146883,1146867,1146867,1146867,1146853,1146853,1146847,1146794,1146791,1146781,1146781,1146781,1146763,1146713,1146713,1126969,1146659,1146644,1146604,1146579,1146568,1146431,1146431,1146255,1146202,1146201,1146169,1146136,1146116,1146111,1146040,1146033,1146006,1146006,1145994,1145939,1145936,1145934,1145895,1145882,1145851,1145828,1145803,1145779,1145779,1145779,1145764,1145744,1145744,1145744,1145742,1145705,1145705,1145705,1145693,1145682,1145619,1145607,1145600,1145566,1145518,1145511,1145472,1145417,1145400,1145377,1145349,1145336,1145310,1145310,1145309,1145306,1145289,1115740,1145248,1145248,1145162,1145151,1145119,1145119,1145119,1145103,1145096,1145095,1140952,1133217,1145050,1145043,1145042,1132933,1144976,1141658,1144932,1144694,1144689,1144640,1144638,1144566,1144566,1144504,1144460,1144454,1144446,1144442,1144340,1144340,1144322,1144299,1142496,1144194,1144171,1144116,1144116,1144068,1144047,1144023,1144005,1143952,1143934,1143904,1143876,1143829,1143804,1143794,1143774,1143760,1143741,1143729,1143671,1143671,1143671,1143659,1143636,1143619,1143619,1143580,1143488,1143488,1143428,1143378,1143359,1143340,1143295,1143279,1143239,1143229,1143229,1143228,1143228,1143214,1143214,1143159,1143148,1143092,1143038,1143034,1143034,1143019,1142970,1142970,1142914,1142908,1142903,1142894,1142889,1142807,1142800,1142756,1142749,1142736,1142735,1142727,1142727,1142688,1142686,1142656,1142644,1142633,1142633,1142633,1142622,1142601,1142572,1142531,1142509,1142502,1142502,1142360,1142350,1142347,1142335,1142325,1142306,1142301,1142301,1142301,1142301,1142260,1142260,1142260,1142238,1142235,1142207,1142207,1142207,1142207,1142187,1142179,1142174,1142162,1142154,1142145,1142134,1142101,1142092,1142078,1141988,1141967,1141961,1141881,1141862,1141828,1141811,1141788,1141773,1141764,1141733,1141726,1141654,1141654,1141654,1141650,1141567,1141567,1141550,1141526,1141524,1141491,1141485,1141480,1141476,1141471,1141466,1141466,1141447,1141447,1141447,1141443,1141384,1141371,1141361,1141360,1141339,1141333,1141292,1141275,1141262,1141246,1141241,1141238,1141206,1141206,1141216,1141214,1141207,1141204,1141189,1141170,1141127,1141127,1141114,1141103,1141071,1141065,1141017,1141017,1141027,1140999,1140980,1140952,1140933,1140931,1140815,1140812,1140809,1140801,1140779,1140766,1140749,1140733,1140711,1140656,1140653,1140642,1140642,1140642,1140576,1140575,1140569,1140562,1140533,1140498,1140447,1140435,1140431,1140408,1140407,1140362,1140354,1140352,1140299,1140290,1140286,1140284,1140270,1138774,1140161,1140107,1140041,1140029,1140023,1140020,1140002,1139996,1139979,1139955,1139951,1139950,1139082,1139891,1139885,1139871,1139821,1139807,1139780,1139753,1139728,1139727,1139631,1139611,1139582,1139548,1139454,1139447,1139447,1139445,1139446,1139444,1139420,1139413,1139402,1139393,1139376,1139350,1139343,1139334,1139301,1139297,1139281,1139239,1139226,1139202,1139191,1139180,1139160,1139127,1139115,1139075,1133682,1139002,1138996,1138989,1138985,1138982,1138969,1138926,1138894,1138829,1138829,1138828,1138826,1138813,1138802,1138798,1138782,1138776,1138774,1138774,1138765,1138754,1138736,1138728,1138702,1138698,1138696,1138693,1138675,1138631,1138628,1138628,1138628,1138612,1138590,1138569,1138497,1138480,1138475,1138457,1138457,1138457,1138457,1138439,1138408,1138398,1138301,1138296,1138282,1138217,1138149,1138130,1138051,1138047,1138044,1138027,1138011,1138004,1138000,1137998,1137974,1137965,1137926,1137906,1137900,1137794,1137776,1137770,1137750,1137737,1137685,1137648,1137616,1137616,1137616,1137599,1137593,1137593,1137593,1137583,1134110,1137549,1137546,1137545,1137541,1137526,1137494,1137491,1137491,1137449,1137438,1137434,1137434,1137432,1137397,1137377,1137366,1137353,1137332,1137268,1137252,1137239,1137175,1137139,1137116,1137112,1137112,1137083,1137069,1137058,1046216,1137043,1137042,1136997,1136993,1136983,1136979,1136979,1136979,1136979,1136976,1136964,1136953,1136931,1136931,1136928,1136928,1136929,1136910,1136899,1136871,1136848,1136796,1136791,1136755,1136755,1136730,1136699,1136632,1136619,1136554,1136540,1136496,1136476,1136472,1136453,1136442,1136415,1136395,1136375,1136359,1136312,1136298,1136285,1136271,1136238,1136183,1115851,1136129,1136126,1136099,1136056,1136056,1136030,1136024,1136024,1136018,1136013,1135991,1135984,1135967,1135952,1135952,1135923,1135915,1135915,1135915,1135915,1135906,1135874,1135868,1135868,1135859,1135854,1135795,1135792,1135784,1135774,1135774,1135749,1135725,1135725,1135706,1135699,1135693,1135693,1135691,1135691,1135685,1135668,1135618,1135616,1135606,1135588,1135580,1135572,1118009,1135495,1135486,1135477,1135467,1135462,1135376,1135334,1135325,1135318,1135316,1135294,1135291,1135281,1135206,1135179,1135166,1135114,1135094,1134971,1134957,1134951,1134931,1134903,1134894,1134891,1134882,1134872,1134853,1134842,1134820,1134833,1134820,1134827,1134798,1134796,1134767,1134757,1134726,1134726,1134706,1134700,1134698,1134680,1134659,1134650,1134552,1134552,1134545,1134545,1134523,1134496,1134477,1134472,1134454,1134451,1134419,1134398,1134388,1134369,1134337,1134325,1134325,1134285,1134262,1134246,1134236,1134237,1134232,1134211,1134189,1134162,1134162,1134135,1134135,1134135,1134116,1134107,1134101,1134089,1134057,1134031,1134017,1134010,1134002,1133951,1133947,1133921,1133921,1133912,1133908,1133908,1133884,1133865,1133839,1133829,1133800,1133800,1133791,1133737,1133726,1133682,1133647,1133638,1133626,1133619,1133619,1133619,1133597,1133573,1133550,1133531,1133512,1133511,1133487,1133459,1133443,1133431,1133407,1133390,1133311,1133304,1133281,1133272,1133272,1133259,1133259,1133223,1133188,1132399,1133121,1133117,1133109,1133109,1133109,1133109,1119624,1133061,1133047,1117092,1117092,1132954,1132943,1132940,1132878,1132878,1132878,1132877,1132877,1132873,1132843,1132841,1132833,1132800,1132800,1132780,1132774,1132756,1132748,1132745,1132745,1132727,1132715,1132705,1132702,1132684,1131670,1132667,1132634,1132603,1132602,1132581,1132567,1132563,1132484,1132476,1121357,1132454,1132454,1132399,1132363,1132322,1132306,1132282,1132296,1132293,1132293,1132251,1132155,1132035,1131974,1131968,1131915,1131878,1131862,1131860,1131860,1131857,1131842,1131832,1131804,1131804,1131797,1131790,1131754,1131751,1131751,1131719,1131719,1131719,1131719,1131677,1131677,1131670,1131670,1110761,1131653,1131547,1131525,1131525,1131517,1131515,1131432,1131432,1131432,1131412,1131412,1131407,1131386,1131381,1131370,1131338,1131326,1131325,1131312,1131281,1131266,1131266,1131247,1131199,1131192,1131152,1131135,1131116,1131116,1131108,1131057,1131046,1130964,1130947,1130930,1130899,1130881,1130880,1130860,1130786,1130763,1130725,1130721,1130719,1130719,1130719,1130720,1130706,1130615,1130605,1130513,1130513,1130386,1130396,1130385,1130369,1130333,1130320,1130320,1130320,1130267,1130224,1130206,1130135,1130095,1130081,1130063,1129972,1129957,1129952,1129930,1129926,1129907,1129855,1129827,1129825,1129812,1129779,1129779,1129790,1129762,1129734,1129733,1129685,1129628,1129621,1129603,1129586,1129577,1129573,1129561,1129555,1129541,1129541,1129519,1129492,1129464,1129454,1129407,1129395,1129392,1129369,1129359,1129334,1129327,1129314,1129289,1129252,1129249,1129235,1129197,1129191,1129183,1129120,1129107,1129098,1129075,1129053,1129024,1128987,1128987,1128987,1128987,1128977,1128977,1128977,1128924,1128858,1128858,1128858,1128854,1128852,1128852,1128852,1128824,1128791,1128783,1128770,1128697,1128697,1128698,1128668,1128662,1128658,1128657,1128643,1128625,1128613,1128589,1128580,1128580,1128558,1128538,1128530,1128529,1128521,1128459,1128436,1128436,1128349,1128349,1128349,1128349,1128349,1128298,1128251,1128239,1120184,1128135,1128045,1128012,1128009,1128000,1127918,1127918,1127918,1127918,1127906,1127879,1127869,1127869,1127869,1127789,1127763,1127730,1127685,1127667,1127651,1127623,1127621,1127620,1127612,1127604,1127604,1127598,1127590,1127540,1127504,1127504,1127503,1127446,1127428,1127428,1127428,1127411,1127405,1127387,1127386,1119244,1127301,1127301,1118307,1127251,1127251,1127249,1127227,1127229,1127218,1127182,1127182,1127136,1127136,1127121,1127083,1127073,1127073,1127044,1126997,1126997,1126994,1126995,1126984,1126984,1126969,1126969,1126942,1126879,1126863,1126863,1126861,1126848,1126809,1126809,1126781,1126749,1126740,1126656,1126654,1126632,1126632,1126642,1126619,1126608,1126592,1126592,1126591,1126546,1126491,1126477,1126461,1126446,1126425,1126425,1126385,1126358,1126357,1126309,1126291,1126291,1126269,1126262,1126258,1126254,1126254,1126250,1126192,1126189,1126158,1126148,1126117,1126070,1126005,1125998,1125944,1125878,1125796,1125759,1125752,1125741,1125741,1125734,1125677,1125651,1125648,1125622,1125622,1125622,1125605,1125605,1125605,1125575,1125557,1125541,1125507,1125488,1125483,1125378,1125262,1125250,1125207,1125195,1122932,1125183,1125181,1125176,1125112,1125109,1125047,1125021,1125003,1124988,1124988,1124987,1124987,1124976,1124884,1124881,1124865,1124859,1124851,1124834,1124834,1124825,1124776,1124767,1124768,1124722,1124719,1124681,1124575,1124548,1124540,1124540,1124535,1124530,1124530,1124530,1124493,1124445,1124445,1124441,1124440,1124438,1124425,1124415,1124415,1124403,1124397,1124393,1124393,1124392,1124392,1124384,1124352,1124346,1124288,1124266,1124258,1124231,1124148,1124148,1124148,1124106,1124106,1124106,1124074,1124031,1124031,1124017,1123979,1123922,1123910,1123875,1123854,1123850,1123836,1123803,1123786,1123774,1123711,1123701,1123682,1123663,1123663,1123663,1123647,1123643,1123640,1123640,1123620,1123617,1123589,1123581,1123570,1123538,1123507,1123478,1123471,1123471,1123406,1123383,1123383,1123383,1123349,1123336,1123268,1123268,1123257,1123200,1123173,1123174,1123156,1123145,1123101,1123099,1123084,1123071,1123052,1123046,1123002,1123002,1122987,1122957,1122936,1122933,1122845,1122831,1122827,1122821,1122794,1122780,1122773,1122756,1122701,1122688,1122667,1122646,1122639,1122622,1122607,1122607,1122607,1122590,1122573,1122573,1122455,1122454,1122346,1122280,1122280,1122243,1122231,1122220,1122189,1122186,1122128,1122105,1122093,1122088,1122079,1122077,1122069,1122061,1122061,1122051,1122015,1121999,1121893,1121890,1121866,1121866,1121845,1121823,1121782,1121782,1121782,1121782,1121720,1121686,1121684,1121684,1121658,1121602,1121598,1121595,1121592,1121590,1121555,1121555,1121550,1121547,1121477,1121459,1121446,1121409,1121409,1121357,1121357,1121357,1121357,1121330,1121322,1121321,1121296,1121278,1121260,1121260,1121251,1121225,1121114,1121110,1121081,1121042,1121040,1121027,1121018,1121005,1121007,1120995,1120995,1120992,1120976,1120930,1120930,1120926,1120920,1120895,1120891,1120891,1120882,1120872,1120872,1120865,1120858,1120807,1120803,1120781,1120772,1120769,1120762,1120762,1120762,1120709,1120700,1120700,1120700,1120692,1120675,1120674,1120664,1120654,1120631,1120631,1115665,1120601,1116416,1120583,1120550,1120453,1116731,1120285,1120266,1120266,1120263,1120245,1120226,1120207,1120207,1120207,1120160,1120160,1120160,1120160,1120122,1120091,1120067,1120043,1120008,1119982,1119961,1119945,1119939,1119939,1119939,1119936,1119932,1119922,1119914,1119914,1119845,1119828,1114817,1119744,1119738,1119725,1119725,1119695,1119673,1119665,1119541,1119535,1119503,1119503,1119503,1119491,1119481,1119481,1119466,1119464,1119432,1119404,1119399,1119396,1119362,1119255,1119248,1119244,1119228,1119218,1119206,1119199,1119177,1119166,1119155,1119098,1119089,1119081,1119033,1119021,1118983,1118936,1118910,1118890,1118887,1118885,1118865,1118861,1118856,1118843,1118817,1118804,1118799,1118788,1118771,1118763,1118746,1118745,1118742,1118732,1118671,1118658,1118635,1118629,1118577,1118567,1118548,1118496,1118483,1118460,1118451,1118446,1118419,1118402,1118396,1118390,1118390,1118387,1118375,1118375,1118375,1118373,1118342,1118333,1118325,1118309,1118309,1118309,1118303,1118292,1118281,1118279,1118269,1118261,1118261,1118248,1118222,1118213,1118177,1118152,1118146,1118146,1118146,1118146,1118137,1118122,1118113,1118113,1118113,1118101,1118082,1118050,1118033,1118028,1118028,1118025,1118022,1118009,1118009,1117945,1117945,1117941,1117881,1117859,1117846,1117840,1117840,1117833,1117817,1117805,1117796,1117796,1117795,1117794,1117786,1117715,1117618,1117605,1117591,1117548,1117548,1117548,1117538,1117538,1117533,1117511,1117488,1117461,1117440,1117426,1117426,1117426,1117367,1117358,1117358,1117192,1117192,1117161,1117161,1117161,1117116,1117116,1117116,1117116,1117104,1117102,1117101,1117100,1117092,1117065,1117036,1117036,1117028,1117028,1117020,1117020,1117002,1116987,1116982,1116978,1116944,1116944,1116944,1116896,1116887,1116875,1116875,1116873,1116806,1116796,1116791,1116789,1116772,1116769,1116760,1116758,1116736,1116731,1116728,1116728,1116581,1116520,1116471,1116441,1116441,1116411,1116401,1116401,1116401,1116253,1116172,1116162,1116142,1116089,1116085,1116085,1116073,1116027,1116023,1115993,1075068,1115951,952552,1115893,1115851,1115833,1115833,1115819,1115808,1115800,1115800,1115774,1115740,1115740,1115740,1115727,1115690,1115681,1115653,1115653,1115653,1115645,1115645,1115608,1115605,1115605,1115588,1115542,1115533,1115533,1115503,1115478,1115462,1115449,1115439,1115439,1115416,1115307,1115305,1115225,1115172,1115162,1115102,1115085,1115054,1115033,1115031,1115017,1114995,1114975,1114961]
        global response
        sno=0

        for ids in inputIdList:

            page_query = "query{"
            page_query += "orderById(id: "+str(ids)+ "){id createdOn status items(first:100){edges{node{ref quantity price}}}fulfilments(first:100){edges{node{id status items(first:100){edges{node{ref}}}}}}}}"

            client = GraphQLClient(graphql_url)
            token = get_token()
            client.inject_token(token)
            response = client.execute(page_query)
            response = json.loads(response)
            #print(response)

            if response is not None:
                sno=sno+1
                print(sno)
                with open('testing.csv','a') as f, open('output.csv','a') as output:


                    orderSKU=[]
                    FulfilmentSKU=[]
                    quantity=[]
                    price=[]

                    f.write(str(sno)+','+response['data']['orderById']['id']+'\n')

                    n=len(response['data']['orderById']['items']['edges'])
                    for k in range(0,n):
                        f.write(','+','+response['data']['orderById']['items']['edges'][k]['node']['ref']+'\n')
                        orderSKU.append(response['data']['orderById']['items']['edges'][k]['node']['ref'])
                        quantity.append(response['data']['orderById']['items']['edges'][k]['node']['quantity'])
                        price.append(response['data']['orderById']['items']['edges'][k]['node']['price'])

                    o=len(response['data']['orderById']['fulfilments']['edges'])

                    for l in range(0,o):
                        f.write(','+','+','+response['data']['orderById']['fulfilments']['edges'][l]['node']['id'])
                        f.write(','+response['data']['orderById']['fulfilments']['edges'][l]['node']['status']+'\n')


                        p=len(response['data']['orderById']['fulfilments']['edges'][l]['node']['items']['edges'])

                        for mm in range(0,p):
                            f.write(','+','+','+','+','+response['data']['orderById']['fulfilments']['edges'][l]['node']['items']['edges'][mm]['node']['ref']+'\n')
                            FulfilmentSKU.append(response['data']['orderById']['fulfilments']['edges'][l]['node']['items']['edges'][mm]['node']['ref'])

                        # if(len(set(orderSKU).symmetric_difference(set(FulfilmentSKU)))==0):
                        #     f.write(','+','+','+','+','+'All SKUs present'+'\n')
                        # else:
                        #     f.write(','+','+','+','+','+str(set(orderSKU).symmetric_difference(set(FulfilmentSKU)))+'\n')

                    if(len(orderSKU)>len(FulfilmentSKU)):
                        f.write(','+','+','+','+','+','+'Unassigned Items'+','+str(set(orderSKU).symmetric_difference(set(FulfilmentSKU)))+'\n')
                    elif(len(orderSKU)<len(FulfilmentSKU)):
                        f.write(','+','+','+','+','+','+'Alert check'+','+str(set(FulfilmentSKU).symmetric_difference(set(orderSKU)))+'\n')
                    else:
                        f.write(','+','+','+','+','+','+'All SKU assigned'+','+str(set(FulfilmentSKU).symmetric_difference(set(orderSKU)))+'\n')




f.close()
output.close()

start = time.time()

get_all_data()

print("Time taken: " + str((time.time()-start)/60) + " minutes")
