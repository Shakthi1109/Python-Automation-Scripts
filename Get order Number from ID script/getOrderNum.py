import csv, time, datetime, ast, json
from graphqlclient import GraphQLClient

graphqlUrl = 'https://PALACIO.api.fluentretail.com/graphql'
client = GraphQLClient(graphqlUrl)
client.inject_token("bearer 3546e152-6c1d-4028-861b-947dfa995bc4")



def process(fulfilmentList):

    f = open('Output.csv','a')
    f.write('Order ID, Order Ref\n')
    i=0
    for ffId in list(fulfilmentList):
        i=i+1
        print(i)
        query = "query{"
        query += "order(id:\""+str(ffId)+"\"){ref}"
        query += "}"
        response = client.execute(query)
        response = json.loads(response)

        f.write(str(ffId)+',')
        for attribute in response['data']['order']['ref']:
            f.write(str(attribute))

        f.write('\n')
    f.close()

    # with open('output.txt','w') as f:
    #     #f.write("id \t status \t ref \t requestedQuantity \t filledQuantity \t rejectedQuantity")
    #     f.write(str(responseList))


start = time.time()

process([40,39,36,35,34,1,655,481,481,481,481,248268,245173,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,242785,241658,240560,238827,231121,225682,225004,225004,225004,225004,225004,225004,225004,225004,225004,224749,224711,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,223980,222692,219561,219561,219561,219561,219561,219561,219561,219561,219561,219510,218687,218687,218687,218687,218687,218687,218687,218687,218687,218457,218273,218273,218273,218273,218273,218273,218273,218273,218273,217644,217644,217644,217644,217644,217644,217644,217644,217644,211113,209906,209906,209906,209906,209475,209257,209257,209257,209257,209151,208534,208534,208534,208534,208534,208534,208534,208534,208534,208133,208133,208133,208133,208133,208133,208133,208133,208133,207400,207400,207400,207400,207029,204553,204376,204229,204229,204229,204229,202920,201740,147557,147557,147557,147557,147545,138694,131852,124976,116586,116586,116586,116586,107496,107490,392880,391386,390853,390853,390853,390853,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,390836,389385,388041,386079,385288,385288,385288,385288,384959,384959,384959,384959,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384526,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,384090,383681,383201,383201,383201,383201,382818,382818,382818,382818,382818,382818,382818,382818,382818,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382209,382129,381935,381935,381935,381935,381409,381409,381409,381409,381109,381109,381109,381109,381109,381109,381109,381109,381109,380989,380989,380989,380989,380989,380989,380989,380989,380989,380989,380989,380989,380989,380989,380989,380989,380696,378788,378175,378175,378175,378175,378175,378175,378175,378175,378175,378175,378175,378175,378175,378175,378175,378175,377397,376369,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,375066,374057,373042,371839,371812,371106,371093,371093,371093,371093,371093,371093,371093,371093,371093,368601,368601,368601,368601,368601,368601,368601,368601,368601,368601,368601,368601,368601,368601,368601,368601,368465,367893,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,367327,364680,364680,364680,364680,364680,364680,364680,364680,364680,364643,364007,364007,364007,364007,364007,364007,364007,364007,364007,363359,363359,363359,363359,361875,361680,361119,360063,357895,356662,355409,355409,355409,355409,355409,355409,355409,355409,355409,353571,353571,353571,353571,353571,353571,353571,353571,353571,353186,353186,353186,353186,353186,353186,353186,353186,353186,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352761,352722,352722,352722,352722,352722,352722,352722,352722,352722,351530,349587,349587,349587,349587,349401,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,348824,345490,344885,344885,344885,344885,344885,344885,344885,344885,344885,344885,344885,344885,344885,344885,344885,344885,344115,344115,344115,344115,344115,344115,344115,344115,344115,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,344080,343744,343719,343719,343719,343719,343474,342497,342268,341817,341641,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,341619,339791,339791,339791,339791,339791,339791,339791,339791,339791,339741,339098,339026,338613,337856,337856,337856,337856,337856,337856,337856,337856,337856,337856,337856,337856,337856,337856,337856,337856,327406,327406,327406,327406,305249,288430,288294,286523,286154,286154,286154,286154,284960,284575,283451,279135,270635,261551,259821,255796,255796,255796,255796,252633,252633,252633,252633,252136,502433,502433,502433,502433,502433,502433,502433,502433,502433,498529,497735,496943,496943,496943,496943,496943,496943,496943,496943,496943,496901,496901,496901,496901,496643,496374,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,495227,494743,494263,494263,494263,494263,494263,494263,494263,494263,494263,494263,494263,494263,494263,494263,494263,494263,493957,492062,492062,492062,492062,491645,489205,489036,489036,489036,489036,488168,480850,480850,480850,480850,480850,480850,480850,480850,480850,480818,480778,480778,480778,480778,480778,480778,480778,480778,480778,480778,480778,480778,480778,480778,480778,480778,480776,475224,474949,474949,474949,474949,474949,474949,474949,474949,474949,474742,474742,474742,474742,474742,474742,474742,474742,474742,474710,474298,474298,474298,474298,474228,474228,474228,474228,473836,473748,473379,473196,473162,473124,473090,472850,472817,472695,472621,472417,472183,472082,472082,472082,472082,472000,471707,471707,471707,471707,471682,465618,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438097,438030,437187,437187,437187,437187,429029,429018,429017,429016,429014,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,425932,417417,417417,417417,417417,417417,417417,417417,417417,417417,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417354,417251,417251,417251,417251,417251,417251,417251,417251,417251,417212,417179,417179,417179,417179,417179,417179,417179,417179,417179,417149,417149,417149,417149,417149,417149,417149,417149,417149,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,417101,416990,416990,416990,416990,416990,416990,416990,416990,416990,416929,416906,416906,416906,416906,416906,416906,416906,416906,416906,416491,416443,416443,416443,416443,415904,415904,415904,415904,415904,415904,415904,415904,415904,415904,415904,415904,415904,415904,415904,415904,415684,415684,415684,415684,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415473,415393,415393,415393,415393,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415358,415335,415335,415335,415335,415335,415335,415335,415335,415335,415335,415335,415335,415335,415335,415335,415335,414646,414646,414646,414646,414646,414646,414646,414646,414646,414646,414646,414646,414646,414646,414646,414646,414644,414382,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,414162,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413946,413898,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,413190,412204,412204,412204,412204,412204,412204,412204,412204,412204,412204,412204,412204,412204,412204,412204,412204,412018,412018,412018,412018,412018,412018,412018,412018,412018,412018,412018,412018,412018,412018,412018,412018,411998,411998,411998,411998,411958,411958,411958,411958,411948,411793,411278,411278,411278,411278,411104,411104,411104,411104,411104,411104,411104,411104,411104,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,411056,410662,410662,410662,410662,410556,410556,410556,410556,410556,410556,410556,410556,410556,410419,410419,410419,410419,410419,410419,410419,410419,410419,410377,410377,410377,410377,410377,410377,410377,410377,410377,410377,410377,410377,410377,410377,410377,410377,410316,410316,410316,410316,410316,410316,410316,410316,410316,410187,410174,410157,410139,410139,410139,410139,410139,410139,410139,410139,410139,410139,410139,410139,410139,410139,410139,410139,410076,410076,410076,410076,410076,410076,410076,410076,410076,409935,409935,409935,409935,409686,409686,409686,409686,409566,409566,409566,409566,409566,409566,409566,409566,409566,409566,409566,409566,409566,409566,409566,409566,409441,409287,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409249,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409154,409025,409009,408986,408986,408986,408986,408986,408986,408986,408986,408986,408986,408986,408986,408986,408986,408986,408986,408928,408928,408928,408928,407781,407354,407191,407191,407191,407191,406957,406911,406784,406205,405601,405599,404820,403466,403105,402905,402808,402494,402122,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401886,401760,401725,401725,401725,401725,401725,401725,401725,401725,401725,401725,401725,401725,401725,401725,401725,401725,400755,400755,400755,400755,400690,400381,400168,400130,399772,399772,399772,399772,397905,397905,397905,397905,397905,397905,397905,397905,397905,397265,396978,396502,395958,395876,395463,395372,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394976,394924,393721,393698,393698,393698,393698,393698,393698,393698,393698,393698,393653,393652,393635,393631,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393593,393489,577226,574968,574947,574946,574926,574926,574923,574920,574903,574903,574903,574903,574903,574903,574903,574903,574903,573983,557423,679445,644668,642420,642382,640113,640113,640113,640113,640113,640113,640113,640113,640113,779279])

print("Time taken: " + str((time.time()-start)/60) + " minutes")
